(()=>{"use strict";function e(){const e=jQuery(".filtry__filter"),t=new URLSearchParams(window.location.search),o={};return e.each(((e,t)=>{(t.classList.contains("filtry__filter--checkbox")||t.classList.contains("filtry__filter--radio"))&&jQuery(t).find("input:checked").each(((e,t)=>{const n=t.dataset.taxonomy,r=t.value;n in o?o[n].push(r):o[n]=[r]}))})),t.has("paged")&&(o.paged=parseInt(t.get("paged"))),t.has("orderby")&&(o.orderby=t.get("orderby")),o}function t(e){const t=new URLSearchParams;for(const o of Object.keys(e)){const n=Array.isArray(e[o])?e[o].join(","):e[o];t.set(o,n)}return t.toString()}function o(){return window.filtrySettings}function n(e=!0){e?document.body.classList.add("filtry--loader-active"):document.body.classList.remove("filtry--loader-active")}function r(e,t=null,r=null){const i=jQuery("ul.products");if(0===i.length)return void console.error("Filtry: Could not find store products container");const c=o();n(!0),function(e,t={}){0===e.length?window.history.pushState(t,"",window.location.href.split("?")[0]):window.history.pushState(t,"",`${window.location.href.split("?")[0]}?${e}`)}(e),jQuery.ajax({url:`${c.rest_url}?${e}`,method:"GET",headers:{"X-WP-Nonce":c.rest_nonce},success:function(e){n(!1),jQuery(".filtry__filters").replaceWith(e.filters),jQuery(".woocommerce-result-count").replaceWith(e.result_count),"function"==typeof t?t(e):(jQuery(".filtry").replaceWith(e.filters),i.html(e.products),jQuery(".woocommerce-pagination").replaceWith(e.pagination))},error:function(e){n(!1),"function"==typeof r&&r(e)}})}function i(e){r(e,(e=>{jQuery("ul.products").html(e.products),jQuery(".woocommerce-result-count").replaceWith(e.result_count),jQuery(".woocommerce-pagination").replaceWith(e.pagination),1===e.max_page?jQuery(".filtry-infinity-load").hide():jQuery(".filtry-infinity-load").show()}))}function c(o){o.preventDefault();const n=o.target.href,r=n.match(/\/page\/(\d+)/);let c=null;if(r)c=parseInt(r[1]);else if(n.split("?").length>1){const e=n.split("?")[1],t=new URLSearchParams(e);t.has("paged")?c=parseInt(t.get("paged")):t.has("page")&&(c=parseInt(t.get("page")))}if(Number.isNaN(c))return void console.error("Filtry: Could not determine page number");const l=e();l.paged=c,i(t(l))}function l(){const o=e();o.paged?o.paged=parseInt(o.paged)+1:o.paged=2,r(t(o),(e=>{jQuery("ul.products").append(e.products),e.current_page>=e.max_page&&jQuery(".filtry-lazy-load").hide()}))}function a(){document.body.classList.remove("filtry--show-popup");const n=e();"paged"in n&&delete n.paged;const r=t(n);!0===o().ajax?i(r):window.location.href=`${window.location.href.split("?")[0]}?${r}`}function u(){!1!==o().autosubmit&&(768>window.innerWidth&&!0===o().mobile_filters||a())}function s(){const e=window.location.href.split("?")[0];window.location.href=e}function d(){jQuery(this).closest(".filtry__filter").toggleClass("filtry__filter--hidden").find(".filtry__list").slideToggle()}function y(){document.body.classList.toggle("filtry--show-popup")}document.addEventListener("DOMContentLoaded",(()=>{jQuery(document.body).on("change",".filtry__toggleable input",u),jQuery(document.body).on("click",".filtry__reset",s),jQuery(document.body).on("click",".filtry__submit",a),jQuery(document.body).on("click",".filtry__filter--collapsable .filtry__filter-head",d),jQuery(document.body).on("click",".filtry__popup-close",y),jQuery(document.body).on("click",".filtry__popup-toggle",y),jQuery(document.body).on("click",".filtry__popup-back",y),jQuery(document.body).on("click",".filtry__mobile-reset",s),jQuery(document.body).on("click",".filtry__mobile-apply",a),!0===o().ajax&&jQuery(document.body).on("click",".woocommerce-pagination a",c),!0===o().ajax&&!0===o().infinity_load&&jQuery(document.body).on("click",".filtry-load-more",l)}))})();
(()=>{"use strict";function t(){return window.filtrySettings}function e(){const t=jQuery(".filtry__filter"),e=new URLSearchParams(window.location.search),o={};return t.each(((t,e)=>{(e.classList.contains("filtry__filter--checkbox")||e.classList.contains("filtry__filter--radio"))&&jQuery(e).find("input:checked").each(((t,e)=>{const n=e.dataset.taxonomy,i=e.value;n in o?o[n].push(i):o[n]=[i]}))})),e.has("paged")&&(o.paged=parseInt(e.get("paged"))),e.has("orderby")&&(o.orderby=e.get("orderby")),o}function o(e,o=!0){const n=new URLSearchParams,{is_taxonomy_page:i,taxonomy:r,term_slug:c}=t();for(const t of Object.keys(e)){let l=Array.isArray(e[t])?e[t]:[e[t]];o&&i&&r===t&&(l=l.filter((t=>t!==c))),0!==l.length&&n.set(t,l.join(","))}return n.toString()}function n(){const o=e(),{shop_page:n,is_taxonomy_page:i,taxonomy:r,term_slug:c}=t();return i?r in o&&-1!==o[r].indexOf(c)?window.location.href.split("?")[0]:(window.filtrySettings.is_taxonomy_page=!1,document.body.dispatchEvent(new CustomEvent("filtry.taxonomy.downgrade")),n):window.location.href.split("?")[0]}function i(t=!0){t?document.body.classList.add("filtry--loader-active"):document.body.classList.remove("filtry--loader-active")}function r(r,c=null,l=null){const a=jQuery("ul.products");if(0===a.length)return void console.error("Filtry: Could not find store products container");const s=t();i(!0),function(t,e={}){const o=n();0===t.length?window.history.pushState(e,"",o):window.history.pushState(e,"",`${o}?${t}`)}(r);const u=o(e(),!1);jQuery.ajax({url:`${s.rest_url}?${u}`,method:"GET",headers:{"X-WP-Nonce":s.rest_nonce},success:function(t){i(!1),jQuery(".filtry__filters").replaceWith(t.filters),jQuery(".woocommerce-result-count").replaceWith(t.result_count),"function"==typeof c?c(t):(jQuery(".filtry").replaceWith(t.filters),a.html(t.products),jQuery(".woocommerce-pagination").replaceWith(t.pagination))},error:function(t){i(!1),"function"==typeof l&&l(t)}})}function c(t){r(t,(t=>{jQuery("ul.products").html(t.products),jQuery(".woocommerce-result-count").replaceWith(t.result_count),jQuery(".woocommerce-pagination").replaceWith(t.pagination),1===t.max_page?jQuery(".filtry-infinity-load").hide():jQuery(".filtry-infinity-load").show(),window.scrollTo({top:100,behavior:"smooth"})}))}function l(t){t.preventDefault();const n=t.target.href,i=n.match(/\/page\/(\d+)/);let r=null;if(i)r=parseInt(i[1]);else if(n.split("?").length>1){const t=n.split("?")[1],e=new URLSearchParams(t);e.has("paged")?r=parseInt(e.get("paged")):e.has("page")&&(r=parseInt(e.get("page")))}if(Number.isNaN(r))return void console.error("Filtry: Could not determine page number");const l=e();l.paged=r,c(o(l))}function a(){const t=e();t.paged?t.paged=parseInt(t.paged)+1:t.paged=2,r(o(t),(t=>{$("ul.products").append(t.products),t.current_page>=t.max_page&&$(".filtry-infinity-load").hide()}))}function s(){document.body.classList.remove("filtry--show-popup");const i=e();"paged"in i&&delete i.paged;const r=o(i);!0===t().ajax?c(r):window.location.href=r.length>0?`${n()}?${r}`:n()}function u(){!1!==t().autosubmit&&(768>window.innerWidth&&!0===t().mobile_filters||s())}function d(){const{shop_page:e}=t();window.location.href=e}function y(){jQuery(this).closest(".filtry__filter").toggleClass("filtry__filter--hidden").find(".filtry__list").slideToggle()}function f(){document.body.classList.toggle("filtry--show-popup")}document.addEventListener("DOMContentLoaded",(()=>{jQuery(document.body).on("change",".filtry__toggleable input",u),jQuery(document.body).on("click",".filtry__reset",d),jQuery(document.body).on("click",".filtry__submit",s),jQuery(document.body).on("click",".filtry__filter--collapsable .filtry__filter-head",y),jQuery(document.body).on("click",".filtry__popup-close",f),jQuery(document.body).on("click",".filtry__popup-toggle",f),jQuery(document.body).on("click",".filtry__popup-back",f),jQuery(document.body).on("click",".filtry__open-filters",f),jQuery(document.body).on("click",".filtry__mobile-reset",d),jQuery(document.body).on("click",".filtry__mobile-apply",s),!0===t().ajax&&jQuery(document.body).on("click",".woocommerce-pagination a",l),!0===t().ajax&&!0===t().infinity_load&&$(document.body).on("click",".filtry-load-more",a)}))})();